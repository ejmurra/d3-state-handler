var d3_state_handler={};d3_state_handler=function(e){function t(e,t,n){for(var a=0,r=e.length;r>a;a++)if(e[a][n]===t)return a;return-1}Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:function(e){"use strict";if(void 0===e||null===e)throw new TypeError("Cannot convert first argument to object");for(var t=Object(e),n=1;n<arguments.length;n++){var a=arguments[n];if(void 0!==a&&null!==a){a=Object(a);for(var r=Object.keys(a),s=0,i=r.length;i>s;s++){var o=r[s],m=Object.getOwnPropertyDescriptor(a,o);void 0!==m&&m.enumerable&&(t[o]=a[o])}}}return t}});var n=function(e,n){var a=this,r=0,s=[],i=function(e){return e},o=n||{loop:!1,init:i,jumpState:{},data:{},load:i},m=o.jumpState,u=o.data,c={},h=function(e){var t=!c[e.name];if(!t)throw new Error("State "+e.name+" already exists!");return c[e.name]={render:e.render,fromNext:e.fromNext||i,fromPrev:e.fromPrev||i,toNext:e.toNext||i,toPrev:e.toPrev||i,jumpOut:e.jumpOut||i,jumpIn:e.jumpIn||i,resize:e.resize||e.render},s.length&&(s[s.length-1].next=e.name),e={prev:s.length?s[s.length-1].name:null,name:e.name,next:null,url:"#"+a.name},s.push(e),e},l=function(){var e=Object.assign({},u);e=c[s[r].name].resize(e),u=Object.assign({},u,e)},f=function(t){t.name=t.name||String(s.length),t=h(t),1===s.length&&e.history.pushState(t,t.name,"#"+t.name)},v=function(){return s[r]},g=function(e){var n=t(s,e,"name");n>-1&&array.splice(n,1)},j=function(n){var a=t(s,n,"name"),i=s[a];if(!(a>-1))throw new Error("State "+n+" does not exist");var h=o.load(Object.assign({},u));h=c[i.name].jumpIn(Object.assign({},m)),h=c[i.name].render(h),u=Object.assign({},u,h),r=a,e.history.pushState(i,i.name,"#"+i.name)},d=function(n){var a=t(s,n,"name"),i=s[r],o=s[a];if(!(a>-1))throw new Error("State "+n+" does not exist");var h=Object.assign({},u);h=c[i.name].jumpOut(h),h=c[o.name].jumpIn(Object.assign({},m)),h=c[o.name].render(h),u=Object.assign({},u,h),r=a,e.history.pushState(o,o.name,"#"+o.name)},p=function(){var n=s[r],a=n.next;if(!a)throw new Error("No state after current state ("+JSON.stringify(n)+")");var i=s[t(s,a,"name")],o=Object.assign({},u);o=c[n.name].toNext(o),o=c[i.name].fromPrev(o),o=c[i.name].render(o),u=Object.assign({},u,o),r=r+1<s.length?r+1:0,e.history.pushState(i,i.name,"#"+i.name)},b=function(){var n=s[r],a=n.prev;if(!a)throw new Error("No state before current state ("+JSON.stringify(n)+")");var i=s[t(s,a,"name")],o=Object.assign({},u);o=c[n.name].toPrev(o),o=c[i.name].fromNext(o),o=c[i.name].render(o),u=Object.assign({},u,o),r=r-1>=0?r-1:s.length-1,e.history.pushState(i,i.name,"#"+i.name)},O=function(n){if(e.addEventListener("popstate",function(a){if(e.history){var r=t(s,e.location.hash.slice(1),"name");e.history.pushState(state[r],state[r].name,"#"+state[r].name),d(e.location.hash.slice(1))}else{var i=Object.assign({},u);i=n?n(i):o.init(i),i=c[s[0].name].render(i),u=Object.assign({},u,i),e.history.pushState(state[0],state[0].name,"#"+state[0].name)}}),e.addEventListener("resize",function(e){l()}),e.location.hash&&e.location.hash.slice(1)!==s[0].name){var a=t(s,e.location.hash.slice(1),"name");e.history.pushState(state[a],state[a].name,"#"+state[a].name),d(e.location.hash.slice(1))}else{var r=Object.assign({},u);r=n?n(r):o.init(r),r=c[s[0].name].render(r),u=Object.assign({},u,r),e.history.pushState(state[0],state[0].name,"#"+state[0].name)}},y={next:p,add:f,currentState:v,prev:b,remove:g,load:j,jumpTo:d,start:O};return y};return e=n}(d3_state_handler);