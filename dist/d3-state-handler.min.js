var d3_state_handler={};d3_state_handler=function(e){function t(e,t,n){for(var a=0,r=e.length;r>a;a++)if(e[a][n]===t)return a;return-1}Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:function(e){"use strict";if(void 0===e||null===e)throw new TypeError("Cannot convert first argument to object");for(var t=Object(e),n=1;n<arguments.length;n++){var a=arguments[n];if(void 0!==a&&null!==a){a=Object(a);for(var r=Object.keys(a),s=0,i=r.length;i>s;s++){var o=r[s],m=Object.getOwnPropertyDescriptor(a,o);void 0!==m&&m.enumerable&&(t[o]=a[o])}}}return t}});var n=function(e,n){var a=0,r=[],s=function(e){return e},i=n||{loop:!1,init:s,jumpState:{},data:{},load:s},o=i.jumpState,m=i.data,u={},c=function(e){var t=!u[e.name];if(!t)throw new Error("State "+e.name+" already exists!");return u[e.name]={render:e.render,fromNext:e.fromNext||s,fromPrev:e.fromPrev||s,toNext:e.toNext||s,toPrev:e.toPrev||s,jumpOut:e.jumpOut||s,jumpIn:e.jumpIn||s,resize:e.resize||e.render},r.length&&(r[r.length-1].next=e.name),e={prev:r.length?r[r.length-1].name:null,name:e.name,next:null,url:"#"+e.name},r.push(e),e},h=function(){var e=Object.assign({},m);e=u[r[a].name].resize(e),m=Object.assign({},m,e)},l=function(t){t.name=t.name||String(r.length),t=c(t),1===r.length&&e.history.pushState(t,t.name,"#"+t.name)},f=function(){return r[a]},v=function(e){var n=t(r,e,"name");n>-1&&array.splice(n,1)},g=function(n){var s=t(r,n,"name"),c=r[s];if(!(s>-1))throw new Error("State "+n+" does not exist");var h=i.load(Object.assign({},m));h=u[c.name].jumpIn(Object.assign({},o)),h=u[c.name].render(h),m=Object.assign({},m,h),a=s,e.history.pushState(c,c.name,"#"+c.name)},j=function(n){var s=t(r,n,"name"),i=r[a],c=r[s];if(!(s>-1))throw new Error("State "+n+" does not exist");var h=Object.assign({},m);h=u[i.name].jumpOut(h),h=u[c.name].jumpIn(Object.assign({},o)),h=u[c.name].render(h),m=Object.assign({},m,h),a=s,e.history.pushState(c,c.name,"#"+c.name)},d=function(){var n=r[a],s=n.next;if(!s)throw new Error("No state after current state ("+JSON.stringify(n)+")");var i=r[t(r,s,"name")],o=Object.assign({},m);o=u[n.name].toNext(o),o=u[i.name].fromPrev(o),o=u[i.name].render(o),m=Object.assign({},m,o),a=a+1<r.length?a+1:0,e.history.pushState(i,i.name,"#"+i.name)},p=function(){var n=r[a],s=n.prev;if(!s)throw new Error("No state before current state ("+JSON.stringify(n)+")");var i=r[t(r,s,"name")],o=Object.assign({},m);o=u[n.name].toPrev(o),o=u[i.name].fromNext(o),o=u[i.name].render(o),m=Object.assign({},m,o),a=a-1>=0?a-1:r.length-1,e.history.pushState(i,i.name,"#"+i.name)},b=function(n){if(e.addEventListener("popstate",function(a){if(e.history){var s=t(r,e.location.hash.slice(1),"name");e.history.pushState(r[s],r[s].name,"#"+r[s].name),j(e.location.hash.slice(1))}else{var o=Object.assign({},m);o=n?n(o):i.init(o),o=u[r[0].name].render(o),m=Object.assign({},m,o),e.history.pushState(r[0],r[0].name,"#"+r[0].name)}}),e.addEventListener("resize",function(e){h()}),e.location.hash&&e.location.hash.slice(1)!==r[0].name){var a=t(r,e.location.hash.slice(1),"name");e.history.pushState(r[a],r[a].name,"#"+r[a].name),j(e.location.hash.slice(1))}else{var s=Object.assign({},m);s=n?n(s):i.init(s),s=u[r[0].name].render(s),m=Object.assign({},m,s),e.history.pushState(r[0],r[0].name,"#"+r[0].name)}},O={next:d,add:l,currentState:f,prev:p,remove:v,load:g,jumpTo:j,start:b};return O};return e=n}(d3_state_handler);